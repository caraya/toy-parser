<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Rohan Parser Playground</title>
		<style>
			body {
				font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
				max-width: 1200px;
				margin: 0 auto;
				padding: 20px;
				background-color: #f5f5f5;
			}
			h1 {
				color: #333;
			}
			.container {
				display: flex;
				gap: 20px;
				height: 80vh;
			}
			.panel {
				flex: 1;
				display: flex;
				flex-direction: column;
				background: white;
				padding: 15px;
				border-radius: 8px;
				box-shadow: 0 2px 4px rgba(0,0,0,0.1);
			}
			textarea {
				flex: 1;
				width: 100%;
				font-family: 'Menlo', 'Monaco', 'Courier New', monospace;
				font-size: 14px;
				padding: 10px;
				border: 1px solid #ddd;
				border-radius: 4px;
				resize: none;
			}
			pre {
				flex: 1;
				overflow: auto;
				background: #f8f9fa;
				padding: 10px;
				border: 1px solid #ddd;
				border-radius: 4px;
				margin: 0;
				font-size: 13px;
			}
			.controls {
				margin-bottom: 10px;
				display: flex;
				gap: 10px;
				align-items: center;
			}
			button {
				padding: 8px 16px;
				background-color: #0066cc;
				color: white;
				border: none;
				border-radius: 4px;
				cursor: pointer;
				font-weight: bold;
			}
			button:hover {
				background-color: #0052a3;
			}
			label {
				font-size: 14px;
				color: #666;
			}
			.stats {
				margin-top: 10px;
				font-size: 12px;
				color: #666;
			}
		</style>
	</head>
	<body>
		<h1>Rohan Parser Playground</h1>

		<div class="container">
			<div class="panel">
				<div class="controls">
					<label>Input HTML</label>
					<button id="parseBtn">Parse</button>
				</div>
				<textarea id="input" placeholder="Enter HTML here...">
					<!DOCTYPE html>
					<html>
						<head>
							<title>Test Page</title>
						</head>
						<body>
							<div id="main" class="container">
								<h1>Hello World</h1>
								<p>This is a <a href="#">link</a>.</p>
								<!-- A comment -->
								<ul>
									<li>Item 1</li>
									<li>Item 2</li>
								</ul>
							</div>
						</body>
					</html>
				</textarea>
			</div>

			<div class="panel">
				<div class="controls">
					<label>Output (DOM Tree)</label>
					<select title="Output Format" id="outputFormat">
						<option value="tree">Tree Structure</option>
						<option value="html">Serialized HTML</option>
						<option value="text">textContent</option>
						<option value="markdown">Markdown</option>
					</select>
				</div>
				<pre id="output"></pre>
				<div class="stats" id="stats"></div>
			</div>
		</div>

		<script src="rohan.bundle.js"></script>
		<script>
			const input = document.getElementById('input');
			const output = document.getElementById('output');
			const parseBtn = document.getElementById('parseBtn');
			const outputFormat = document.getElementById('outputFormat');
			const stats = document.getElementById('stats');
			
			function renderTree(node, indent = 0) {
				let result = "";
				const prefix = "  ".repeat(indent);
				
				if (node.nodeType === 9) { // Document
				result += `${prefix}#document\n`;
				node.childNodes.forEach(child => {
					result += renderTree(child, indent + 1);
					});
					} else if (node.nodeType === 10) { // Doctype
					result += `${prefix}<!DOCTYPE ${node.name}>\n`;
					} else if (node.nodeType === 1) { // Element
					let attrs = "";
					if (node.attrs && Object.keys(node.attrs).length > 0) {
						attrs = " " + Object.entries(node.attrs)
						.map(([k, v]) => `${k}="${v}"`)
						.join(" ");
					}
					result += `${prefix}<${node.tagName}${attrs}>\n`;
					node.childNodes.forEach(child => {
						result += renderTree(child, indent + 1);
						});
						} else if (node.nodeType === 3) { // Text
						const text = node.textContent.replace(/\n/g, '\\n');
						if (text.trim() || text === '\\n') {
							result += `${prefix}"${text}"\n`;
						}
						} else if (node.nodeType === 8) { // Comment
						result += `${prefix}<!-- ${node.textContent} -->\n`;
					}
					
					return result;
				}
				
				function parse() {
					const html = input.value;
					const startTime = performance.now();
					
					try {
						const parser = new JustHTML(html);
						const endTime = performance.now();
						const duration = (endTime - startTime).toFixed(2);
						
						const format = outputFormat.value;
						let result = "";
						
						if (format === 'tree') {
							result = renderTree(parser.root);
							} else if (format === 'html') {
								result = parser.root.toHtml();
								} else if (format === 'text') {
									result = parser.root.toText();
									} else if (format === 'markdown') {
										result = parser.root.toMarkdown();
									}
									
									output.textContent = result;
									stats.textContent = `Parsed in ${duration}ms`;
									} catch (e) {
										output.textContent = "Error: " + e.message;
										console.error(e);
									}
								}
								
								parseBtn.addEventListener('click', parse);
								outputFormat.addEventListener('change', parse);
								
								// Initial parse
								parse();
		</script>
	</body>
</html>
